<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-ci-cd/Docker-Images">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">3.1 Docker Images and CI/CD | Learn Web Dev</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://learn-web-dev.jasys.xyz//docs/ci-cd/Docker-Images"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="3.1 Docker Images and CI/CD | Learn Web Dev"><meta data-rh="true" name="description" content="Introduction"><meta data-rh="true" property="og:description" content="Introduction"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://learn-web-dev.jasys.xyz//docs/ci-cd/Docker-Images"><link data-rh="true" rel="alternate" href="https://learn-web-dev.jasys.xyz//docs/ci-cd/Docker-Images" hreflang="en"><link data-rh="true" rel="alternate" href="https://learn-web-dev.jasys.xyz//docs/ci-cd/Docker-Images" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Learn Web Dev RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Learn Web Dev Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BTX9ZBR2LF"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-BTX9ZBR2LF",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.4b72df68.css">
<link rel="preload" href="/assets/js/runtime~main.ca9a8f1a.js" as="script">
<link rel="preload" href="/assets/js/main.aefab9c1.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Learn Web Development" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="Learn Web Development" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Learn Web Dev</b></a><a class="navbar__item navbar__link" href="/docs/introduction/GettingStarted">Tutorial</a></div><div class="navbar__items navbar__items--right"><a href="https://gitlab.com/2022-engineering-bootcamp-gds" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitLab<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/0-introduction">0. Introduction</a><button aria-label="Toggle the collapsible sidebar category &#x27;0. Introduction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/1-backend">1. Backend</a><button aria-label="Toggle the collapsible sidebar category &#x27;1. Backend&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/2-frontend">2. Frontend</a><button aria-label="Toggle the collapsible sidebar category &#x27;2. Frontend&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/3-continuous-integration--continuous-deployment">3. Continuous Integration &amp; Continuous Deployment</a><button aria-label="Toggle the collapsible sidebar category &#x27;3. Continuous Integration &amp; Continuous Deployment&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ci-cd/DevOps-Setup">3.0 Devops Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/ci-cd/Docker-Images">3.1 Docker Images and CI/CD</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ci-cd/CICD-Enhancements">3.2 CI/CD Pipeline Enhancements</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/4-infrastructure-as-code">4. Infrastructure as Code</a><button aria-label="Toggle the collapsible sidebar category &#x27;4. Infrastructure as Code&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/3-continuous-integration--continuous-deployment"><span itemprop="name">3. Continuous Integration &amp; Continuous Deployment</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">3.1 Docker Images and CI/CD</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>3.1 Docker Images and CI/CD</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">​</a></h2><p>In this exercise, we will be investigating how Docker Compose works and create a CI/CD pipeline with GitHub Actions to automatically build and push images to GitHub Container Registry.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">​</a></h2><ol><li>Installed Docker Desktop</li><li>Forked the repository and checkout <code>main</code> branch to have the completed frontend and backend</li><li>Successfully ran <code>docker-compose up</code> for the frontend and backend from yesterday&#x27;s workshop</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="exercises">Exercises<a class="hash-link" href="#exercises" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-docker-composeyml">Understanding docker-compose.yml<a class="hash-link" href="#understanding-docker-composeyml" title="Direct link to heading">​</a></h3><p>In earlier workshops, you were able to run the frontend and backend servers locally using the <code>docker-compose up</code> command.</p><p>This was made possible with the help of the <code>docker-compose.yml</code> file, which consists of the necessary configurations to build images, mount volumes, expose ports, run containers, etc.</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;3.0&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">frontend</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">build</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ../frontend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;npm start&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">environment</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token key atrule" style="color:#00a4db">API_ENDPOINT</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">//backend</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">9000/api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ../frontend</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/home/node/app/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 3000</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">3000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">backend</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">build</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ../backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">command</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;npm run dist&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> ../backend</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">/home/node/app/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> 9000</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">9000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Let&#x27;s breakdown the configurations for the frontend service, which can be applied to the backend as well:</p><ol><li><code>build: ../frontend</code>: Specifies the build context (ie. path to the Dockerfile). This is like running the <code>docker build ../frontend</code> command.</li><li><code>command: &quot;npm start&quot;</code>: Specifies the command to be executed by the container. Overrides <code>CMD</code> in the Dockerfile.</li><li><code>environment:</code>: Specifies environment variables.</li><li><code>volumes: - ../frontend:/home/node/app/</code>: Mount a host path. The syntax is <code>SOURCE:TARGET</code>. In this case, <code>../frontend</code> from the host is mounted to <code>/home/node/app/</code> in the container.</li><li><code>ports: - 3000:3000</code>: Expose ports in the format <code>HOST:CONTAINER</code>.</li></ol><p>You will need to modify this file in a later exercise. Optionally, you may wish to view the full <a href="https://docs.docker.com/compose/compose-file/compose-file-v3/" target="_blank" rel="noopener noreferrer">Docker Compose configuration reference</a> for further learning.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="optimizing-images">Optimizing Images<a class="hash-link" href="#optimizing-images" title="Direct link to heading">​</a></h3><p>There are lots of ways to write a Dockerfile to containerize your application. While the resulting container may be functional, it may not be the most optimized. Here are some considerations when creating a Docker image.</p><ol><li>Higher storage requirements. You may easily exceed storage quotas in your container registries.</li><li>Higher bandwidth utilization to download and upload images.</li><li>Potentially slower image build times.</li></ol><p>If we take a look at one of the Dockerfiles (either in <code>/frontend</code> or <code>/backend</code>), we will notice the first line <code>FROM node:alpine</code>. This specifies the parent image to be used to build the image.</p><p>In this case, the <code>node:alpine</code> image is built from Alpine Linux Project with Node.js installed, which is much smaller than most distribution images. Unlike images like <code>node:latest</code>, which is build with a bunch of additional source controls software, libraries and build tools. You may not require all these additional tools in most cases.</p><p>You can view other image variants for Node.js <a href="https://hub.docker.com/_/node" target="_blank" rel="noopener noreferrer">here</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="stopping-the-application">Stopping The Application<a class="hash-link" href="#stopping-the-application" title="Direct link to heading">​</a></h3><p>Once done, run <code>docker-compose down</code> to stop the containers that are running locally.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="build-and-push-images-with-gitlab-pipeline">Build and Push Images with Gitlab Pipeline<a class="hash-link" href="#build-and-push-images-with-gitlab-pipeline" title="Direct link to heading">​</a></h3><p>There are drawbacks to the way we build and run our application now:</p><ol><li>It is difficult to share images with other members in the project team since everything is done locally.</li><li>We must manually run commands to rebuild images every time any code changes are made.</li></ol><p>Fortunately, we can resolve both issues with the help of container registries and automation.</p><ol><li>Images can be pushed (uploaded) to a container registry, which can be pulled (downloaded) by the rest of your team. Container registries are a central place to store and distribute images. Some examples include Dockerhub and the GitHub Container Registry (GHCR).</li><li>We can configure CI/CD pipelines to automatically build and push the images to a container registry. This can be achieved using Gitlab Pipeline.</li></ol><p>Note that it is a best practice to use a unique tag for each image pushed to a container registry. This is to ensure that images are immutable (ie. will not be changed). For example, we can use the Git commit SHA for the image tag.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="register-runner-locally-optional-skip-this-if-you-want-to-use-gitlab-provided-shared-runners">Register Runner Locally (Optional, Skip this if you want to use Gitlab Provided Shared Runners)<a class="hash-link" href="#register-runner-locally-optional-skip-this-if-you-want-to-use-gitlab-provided-shared-runners" title="Direct link to heading">​</a></h3><ol><li>Start Docker on your computer if it’s not already running</li><li>Install the gitlab-runner binary on your machine<ul><li><a href="https://docs.gitlab.com/runner/install/osx.html?_gl=1*wo382l*_ga*MzUwODI4Nzk1LjE2NjEwODY1MzA.*_ga_ENFH3X7M5Y*MTY2MjkwMzk2NS4xMi4xLjE2NjI5MDQwMjIuMC4wLjA.#manual-installation-official" target="_blank" rel="noopener noreferrer">Runner for Mac</a></li><li><a href="https://docs.gitlab.com/runner/install/windows.html?_gl=1*1hhpc8*_ga*MzUwODI4Nzk1LjE2NjEwODY1MzA.*_ga_ENFH3X7M5Y*MTY2MjkwMzk2NS4xMi4xLjE2NjI5MDQwMjIuMC4wLjA.#installation" target="_blank" rel="noopener noreferrer">Runner for Windows</a></li></ul></li><li>Register runner with Docker executor to Gitlab workspace<ul><li>Within the group where you have forked your projects</li><li>On the Group&#x27;s sidebar, Go to CI/CD -&gt; Runners</li><li>Select <strong>Register a group runner</strong> and and copy the Registration token</li><li>On your machine&#x27;s terminal<ol><li>Run. <strong>gitlab-runner register</strong></li><li>Register runner with URL: <a href="https://gitlab.com" target="_blank" rel="noopener noreferrer">https://gitlab.com</a></li><li>Paste the Registration Token copied earlier</li><li>Description: (enter) to accept default </li><li>Tags: Type byod-runner</li><li>Executor: Type Docker</li><li>Docker Image: alpine:latest</li></ol></li><li>Modify the gitlab-runner configuration file <ol><li>Located: <ul><li>~/.gitlab-runner/config.toml (Mac)</li><li>C:\Gitlab-Runner\config.toml (Windows)</li></ul></li><li>Find your gitlab runner and replace the volume setting with: <!-- -->[“/var/run/docker.sock:/var/run/docker.sock”, “/cache”]</li><li>Run gitlab-runner restart to apply the changes</li></ol></li></ul></li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="exercise-1">Exercise 1<a class="hash-link" href="#exercise-1" title="Direct link to heading">​</a></h4><p>Create a pipeline using GitHub Pipeline to build, publish and deploy the frontend and backend images to Amazon Web Services.</p><p><strong>Steps:</strong></p><ol><li>Create a <code>.gitlab-ci.yml</code> file at the root folder of both your frontend and backend app. </li><li>Copy and paste the baseline configuration provided to you below and replace the <code>&lt;INSERT COMMANDS HERE&gt;</code>. </li><li>Commit your newly created pipeline file. Gitlab Pipeline should automatically start running. You can view it at the &quot;CI/CD -&gt; Pipelines&quot; tab in your repository sidebar.</li><li>Verify that the pipeline completes successfully, where Build, Test and Publish should complete</li><li>Note that the deploy stage will be set to manual since we have not setup the Container Service yet.</li></ol><p>Hint: You would run the same commands used to build a Docker image locally as you would in the CI/CD pipeline. Consider using <code>docker build</code> and <code>docker push</code>.</p><p>Here&#x27;s the baseline configuration (<code>.gitlab-ci.yml</code>) for you to get started:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">include</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token key atrule" style="color:#00a4db">project</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&lt;INSERT PATH TO TEMPLATES&gt;/templates&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Location of aws assume-role template </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ref</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;main&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">file</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> .gitlab</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">aws</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cli.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">stages</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> publish</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Build stage will build your docker image and stage a copy in Gitlab&#x27;s Container Registry</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">build-stage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> docker</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">stable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">stage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">variables</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Variable holding the name of Gitlab Container Registry</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">CONTAINER_BUILD_IMAGE</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $CI_REGISTRY_IMAGE</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">tags</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Use tags if you have setup your own local Gitlab Runner, else you can omit this</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> &lt;INSERT TAG HERE</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">before_script</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Login to Gitlab Conatiner Registry</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> docker login </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">u $CI_REGISTRY_USER </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">p $CI_REGISTRY_PASSWORD $CI_REGISTRY </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">script</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Build and tag your image to the name of $CONTAINER_BUILD_IMAGE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> docker build </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">t $CONTAINER_BUILD_IMAGE .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Push image to Gitlab Container Registry</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> docker push $CONTAINER_BUILD_IMAGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Test stage will be used to run unit testing to make sure your image is ready to be deployed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">test-stage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">alpine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">stage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">tags</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Use tags if you have setup your own local Gitlab Runner, else you can omit this</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> &lt;INSERT TAG HERE</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">before_script</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> npm install</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">script</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> npm run test</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">extra</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Publish stage will establish a connection with AWS and publish your staged image to the Elastic Container Registry</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">publish-stage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Extends defines the job action that it inherited from</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">extends</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> .invoke</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">awscli</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">commands</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">with</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">assumerole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># This image is a special image that is build with both Docker and AWS components</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> $CI_REGISTRY/&lt;PATH TO TEMPLATES</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain">/templates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">entrypoint</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;/usr/bin/env&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">tags</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Use tags if you have setup your own local Gitlab Runner, else you can omit this</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> &lt;INSERT TAG HERE</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">variables</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Enter ROLE_ARN of your created role from the previous aws setup</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ROLE_ARN</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> &lt;INSERT ROLE IDENTITY</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ECR_REGISTRY</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> &lt;INSERT ECR REGISTRY NAME</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">stage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> publish</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">script</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Login to Gitlab Conatiner Registry</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> docker login </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">u $CI_REGISTRY_USER </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">p $CI_REGISTRY_PASSWORD $CI_REGISTRY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Retrieve Image from Registry</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> docker pull $CI_REGISTRY_IMAGE</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Re-Tag pulled image to ECR Registry Name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> docker tag $CI_REGISTRY_IMAGE</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest $ECR_REGISTRY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Login to ECR Registry </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> aws ecr get</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">login</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">password </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">region ap</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">southeast</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">1 </span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain"> docker login </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">username AWS </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">password</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">stdin &lt;INSERT YOUR ECR ENDPOINT</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Push to ECR Registry</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> docker push $ECR_REGISTRY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Deploy stage will run an ecs update command to force a new image deployment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">deploy-stage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">extends</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> .invoke</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">awscli</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">commands</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">with</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">assumerole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">stage</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">tags</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># Use tags if you have setup your own local Gitlab Runner, else you can omit this</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> &lt;INSERT TAG HERE</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">variables</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Enter ROLE_ARN of your created role from the previous aws setup</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ROLE_ARN</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> &lt;INSERT ROLE IDENTITY</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">script</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Command to update ECS Service</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> aws ecs update</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">service </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">cluster &lt;INSERT ECS CLUSTER NAME</span><span class="token punctuation" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">service backend</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">app </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">force</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">new</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">deployment </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">region ap</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">southeast</span><span class="token punctuation" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Enforces manual triggered deployment to prevent accidental runs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">when</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> manual</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-built-images">Using Built Images<a class="hash-link" href="#using-built-images" title="Direct link to heading">​</a></h3><p>The current docker-compose.yml file builds the image locally and runs it.</p><p>We can modify the file to pull the images from Gitlab Registry that you just pushed instead. This is useful when sharing images with other team members and to ensure that everyone is using a consistent image to run their application.</p><p>These images can also be used for cloud deployments, which you will get to try in the next few exercises.</p><p>In the next exercise, we will begin deploying the frontend and Backend to AWS so that the application is accessible over the web.</p><hr></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/ci-cd/31-Docker-Images.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/ci-cd/DevOps-Setup"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">3.0 Devops Setup</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/ci-cd/CICD-Enhancements"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">3.2 CI/CD Pipeline Enhancements</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#exercises" class="table-of-contents__link toc-highlight">Exercises</a><ul><li><a href="#understanding-docker-composeyml" class="table-of-contents__link toc-highlight">Understanding docker-compose.yml</a></li><li><a href="#optimizing-images" class="table-of-contents__link toc-highlight">Optimizing Images</a></li><li><a href="#stopping-the-application" class="table-of-contents__link toc-highlight">Stopping The Application</a></li><li><a href="#build-and-push-images-with-gitlab-pipeline" class="table-of-contents__link toc-highlight">Build and Push Images with Gitlab Pipeline</a></li><li><a href="#register-runner-locally-optional-skip-this-if-you-want-to-use-gitlab-provided-shared-runners" class="table-of-contents__link toc-highlight">Register Runner Locally (Optional, Skip this if you want to use Gitlab Provided Shared Runners)</a></li><li><a href="#using-built-images" class="table-of-contents__link toc-highlight">Using Built Images</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction/GettingStarted">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://gitlab.com/2022-engineering-bootcamp-gds" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitLab<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Learn Web Dev, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.ca9a8f1a.js"></script>
<script src="/assets/js/main.aefab9c1.js"></script>
</body>
</html>